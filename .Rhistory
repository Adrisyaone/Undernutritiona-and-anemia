}
ch3<-conc_chart(dt1, dt2, dt3, chart_of = "Anemia")
concentration_curve<-function(dt,inq_var, outcome, weight, type=c("CI"), method=c("linreg_delta")){
if(!require(rineq)) install.packages("rineq")
dt<-data.frame(dt)
dt$inq_var=as.numeric(dt[, inq_var])
dt$outcome=dt[, outcome]
dt$wt=dt[,weight]
dt<-data.frame(dt)
k<-rineq::ci(ineqvar =dt$inq_var ,outcome = dt$outcome, weights = dt$wt,type = "CI",method = "linreg_delta",robust_se = T)
dt<-hci(k)
return(dt)
}
conc_chart <- function(dt1, dt2, dt3, chart_of){
chart1<-ggplot()+
geom_segment(aes(x = 0, xend = 1, y = 0, yend = 1),col="black", lwd=1.3)+
geom_line(data=dt1,aes(x=xCoord, y = cumdist,col="2022"), lwd=1.1)+
geom_line(data=dt2,aes(x=xCoord, y = cumdist,col="2016"), lwd=1.1)+
geom_line(data=dt3,aes(x=xCoord, y = cumdist,col="2011"), lwd=1.1)+
scale_y_continuous(
paste0("Cummulative share of ", chart_of, "\n"), expand = c(0, 0),
sec.axis = sec_axis(~ . *1)
)+
scale_x_continuous(
"\nCummulative share of children ranked by wealth", expand = c(0, 0),
sec.axis = sec_axis(~ . *1)
)+
scale_color_manual("Year",values = c("orange", "red","navy"))+
labs(title = "A")+
theme(axis.title = element_text(size = 13, face="bold"),
legend.title = element_text(size=13, face="bold"),
axis.text.y.right = element_blank(),
axis.text.x.top = element_blank())
return(chart1)
}
# Concentration index for stunting
dt1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt")
dt2<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt")
dt3<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt")
ch1<-conc_chart(dt1, dt2, dt3, chart_of = "Stunting")
ch1
# concentration index for wasting
dt1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "wasting",weight = "sampling_wt")
dt2<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "wasting",weight = "sampling_wt")
dt3<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "wasting",weight = "sampling_wt")
ch2<-conc_chart(dt1, dt2, dt3, chart_of = "Wasting")
ch2
# concentration index for anemia
dt1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "anemia",weight = "sampling_wt")
ch2<-conc_chart(dt1, dt2, dt3, chart_of = "Wasting")
ch2
# concentration index for anemia
dt1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "Anemia",weight = "sampling_wt")
dt2<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "Anemia",weight = "sampling_wt")
dt3<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "Anemia",weight = "sampling_wt")
ch3<-conc_chart(dt1, dt2, dt3, chart_of = "Anemia")
ch3
PRdata$combined_indicator
# merge datasets
PRdata<-bind_rows(PRdata22, PRdata16, PRdata11)
# set sampling wt to correct length
PRdata <- PRdata %>%
mutate(sampling_wt = hv005/1000000) |>
mutate(combined_indicator=paste0(nt_ch_stunt, nt_ch_wast, nt_ch_any_anem),
agemonths<-as.factor(agemonths),
stunting=ifelse(nt_ch_stunt==1, 1,0),
wasting=ifelse(nt_ch_wast==1, 1,0),
Anemia=ifelse(nt_ch_any_anem==1, 1,0),
cooccurence=ifelse(combined_indicator=="111",1, 0))
dt1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "cooccurence",weight = "sampling_wt")
dt2<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "cooccurence",weight = "sampling_wt")
dt3<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "cooccurence",weight = "sampling_wt")
ch4<-conc_chart(dt1, dt2, dt3, chart_of = "Co-occurence")
ch4
dt1
concentration_curve<-function(dt,inq_var, outcome, weight, type=c("CI"), method=c("linreg_delta"), out=c(1,2)){
if(!require(rineq)) install.packages("rineq")
dt<-data.frame(dt)
dt$inq_var=as.numeric(dt[, inq_var])
dt$outcome=dt[, outcome]
dt$wt=dt[,weight]
dt<-data.frame(dt)
k<-rineq::ci(ineqvar =dt$inq_var ,outcome = dt$outcome, weights = dt$wt,type = "CI",method = "linreg_delta",robust_se = T)
dt<-hci(k)
ifelse(out==1, return(dt), return(k))
}
dt1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt", out = 2)
dt1
summar(dt1)
summary(dt1)
concentration_curve<-function(dt,inq_var, outcome, weight, type=c("CI"), method=c("linreg_delta"), out=c(1,2)){
if(!require(rineq)) install.packages("rineq")
dt<-data.frame(dt)
dt$inq_var=as.numeric(dt[, inq_var])
dt$outcome=dt[, outcome]
dt$wt=dt[,weight]
dt<-data.frame(dt)
k<-rineq::ci(ineqvar =dt$inq_var ,outcome = dt$outcome, weights = dt$wt,type = "CI",method = "linreg_delta",robust_se = T)
dt<-hci(k)
ifelse(out==1, return(dt), return(summary(k)))
}
conc_chart <- function(dt1, dt2, dt3, chart_of){
chart1<-ggplot()+
geom_segment(aes(x = 0, xend = 1, y = 0, yend = 1),col="black", lwd=1.3)+
geom_line(data=dt1,aes(x=xCoord, y = cumdist,col="2022"), lwd=1.1)+
geom_line(data=dt2,aes(x=xCoord, y = cumdist,col="2016"), lwd=1.1)+
geom_line(data=dt3,aes(x=xCoord, y = cumdist,col="2011"), lwd=1.1)+
scale_y_continuous(
paste0("Cummulative share of ", chart_of, "\n"), expand = c(0, 0),
sec.axis = sec_axis(~ . *1)
)+
scale_x_continuous(
"\nCummulative share of children ranked by wealth", expand = c(0, 0),
sec.axis = sec_axis(~ . *1)
)+
scale_color_manual("Year",values = c("orange", "red","navy"))+
labs(title = "A")+
theme(axis.title = element_text(size = 13, face="bold"),
legend.title = element_text(size=13, face="bold"),
axis.text.y.right = element_blank(),
axis.text.x.top = element_blank())
return(chart1)
}
conc_chart <- function(dt1, dt2, dt3, chart_of){
chart1<-ggplot()+
geom_segment(aes(x = 0, xend = 1, y = 0, yend = 1),col="black", lwd=1.3)+
geom_line(data=dt1,aes(x=xCoord, y = cumdist,col="2022"), lwd=1.1)+
geom_line(data=dt2,aes(x=xCoord, y = cumdist,col="2016"), lwd=1.1)+
geom_line(data=dt3,aes(x=xCoord, y = cumdist,col="2011"), lwd=1.1)+
scale_y_continuous(
paste0("Cummulative share of ", chart_of, "\n"), expand = c(0, 0),
sec.axis = sec_axis(~ . *1)
)+
scale_x_continuous(
"\nCummulative share of children ranked by wealth", expand = c(0, 0),
sec.axis = sec_axis(~ . *1)
)+
scale_color_manual("Year",values = c("orange", "red","navy"))+
labs(title = "A")+
theme_bw()+
theme(axis.title = element_text(size = 13, face="bold"),
legend.title = element_text(size=13, face="bold"),
axis.text.y.right = element_blank(),
axis.text.x.top = element_blank())
return(chart1)
}
# Concentration index for stunting
dt1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt", out = 2)
dt2<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt")
dt3<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt")
dt1.1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt", out = 2)
dt2.1<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt", out=2)
dt3.1<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt", out=2)
dt1.1
dt2.1
dt3.1
ch1<-conc_chart(dt1, dt2, dt3, chart_of = "Stunting")
ch1
# Concentration index for stunting
dt1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt", out = 1)
dt2<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt", out=1)
dt3<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt", out=1)
dt1.1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt", out = 2)
dt2.1<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt", out=2)
dt3.1<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt", out=2)
dt1.1
dt2.1
dt3.1
ch1<-conc_chart(dt1, dt2, dt3, chart_of = "Stunting")
ch1
plot_grid( ch1,ch2,ch3,ch4,
labels = c("A", "B", "C", "D","E","F"),
hjust = -1,
nrow = 3)+xlab("Cummulative share of women ranked by wealth")+
ylab("Cummulative share of Barrier to health care access")
p123<-ch1+ch2+ch3+ch4+plot_layout(ncol=2, guides = "collect",axis_titles = "collect", design = "AB\nCD\nEF",tag_level = "keep") & theme(legend.position = 'bottom')
library("patchwork")
p123<-ch1+ch2+ch3+ch4+plot_layout(ncol=2, guides = "collect",axis_titles = "collect", design = "AB\nCD\nEF",tag_level = "keep") & theme(legend.position = 'bottom')
p123
# Concentration index for stunting
dt1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt", out = 1)
dt2<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt", out=1)
dt3<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt", out=1)
dt1.1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt", out = 2)
dt2.1<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt", out=2)
dt3.1<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt", out=2)
dt1.1
dt2.1
dt3.1
ch1<-conc_chart(dt1, dt2, dt3, chart_of = "Stunting")
ch1
# concentration index for wasting
dt1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "wasting",weight = "sampling_wt", out=1)
dt2<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "wasting",weight = "sampling_wt", out=1)
dt3<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "wasting",weight = "sampling_wt", out=1)
dt1.1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "wasting",weight = "sampling_wt", out = 2)
dt2.1<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "wasting",weight = "sampling_wt", out=2)
dt3.1<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "wasting",weight = "sampling_wt", out=2)
dt1.1
dt2.1
dt3.1
ch2<-conc_chart(dt1, dt2, dt3, chart_of = "Wasting")
ch2
# concentration index for anemia
dt1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "Anemia",weight = "sampling_wt", out=1)
dt2<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "Anemia",weight = "sampling_wt",out=1)
dt3<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "Anemia",weight = "sampling_wt", out=1)
dt1.1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "Anemia",weight = "sampling_wt", out = 2)
dt2.1<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "Anemia",weight = "sampling_wt", out=2)
dt3.1<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "Anemia",weight = "sampling_wt", out=2)
dt1.1
dt2.1
dt3.1
ch3<-conc_chart(dt1, dt2, dt3, chart_of = "Anemia")
ch3
# concentration index for anemia
dt1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "cooccurence",weight = "sampling_wt", out=1)
dt2<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "cooccurence",weight = "sampling_wt", out=1)
dt3<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "cooccurence",weight = "sampling_wt", out=1)
dt1.1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "cooccurence",weight = "sampling_wt", out = 2)
dt2.1<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "cooccurence",weight = "sampling_wt", out=2)
dt3.1<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "cooccurence",weight = "sampling_wt", out=2)
dt1.1
dt2.1
dt3.1
ch4<-conc_chart(dt1, dt2, dt3, chart_of = "Co-occurence")
ch4
library("patchwork")
p123<-ch1+ch2+ch3+ch4+plot_layout(ncol=2, guides = "collect",axis_titles = "collect", design = "AB\nCD\nEF",tag_level = "keep") & theme(legend.position = 'bottom')
p123
dt1.1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt", out = 2)
dt2.1<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt", out=2)
dt3.1<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt", out=2)
dt1.1
dt2.1
dt3.1
library("patchwork")
library(cowplot)
library(gridExtra)
plot_grid( ch1,ch2,ch3,ch4,
labels = c("A", "B", "C", "D"),
hjust = -1,
nrow = 3)+xlab("Cummulative share of women ranked by wealth")+
ylab("Cummulative share of Nutritonla status")
p124
p123
plot_grid( ch1,ch2,ch3,ch4,
labels = c("A", "B", "C", "D"),
hjust = -1,
nrow = 2)+xlab("Cummulative share of women ranked by wealth")+
ylab("Cummulative share of Nutritonla status")
conc_chart <- function(dt1, dt2, dt3, chart_of){
chart1<-ggplot()+
geom_segment(aes(x = 0, xend = 1, y = 0, yend = 1),col="black", lwd=1.3)+
geom_line(data=dt1,aes(x=xCoord, y = cumdist,col="2022"), lwd=1.1)+
geom_line(data=dt2,aes(x=xCoord, y = cumdist,col="2016"), lwd=1.1)+
geom_line(data=dt3,aes(x=xCoord, y = cumdist,col="2011"), lwd=1.1)+
scale_y_continuous(
paste0("Cummulative share of ", chart_of, "\n"), expand = c(0, 0),
sec.axis = sec_axis(~ . *1)
)+
scale_x_continuous(
"", expand = c(0, 0),
sec.axis = sec_axis(~ . *1)
)+
scale_color_manual("Year",values = c("orange", "red","navy"))+
labs(title = "A")+
theme_bw()+
theme(axis.title = element_text(size = 13, face="bold"),
legend.title = element_text(size=13, face="bold"),
axis.text.y.right = element_blank(),
axis.text.x.top = element_blank())
return(chart1)
}
# Concentration index for stunting
dt1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt", out = 1)
dt2<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt", out=1)
dt3<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt", out=1)
dt1.1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt", out = 2)
dt2.1<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt", out=2)
dt3.1<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt", out=2)
summary(dt1.1)
dt2.1
dt3.1
ch1<-conc_chart(dt1, dt2, dt3, chart_of = "Stunting")
ch1
# concentration index for wasting
dt1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "wasting",weight = "sampling_wt", out=1)
dt2<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "wasting",weight = "sampling_wt", out=1)
dt3<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "wasting",weight = "sampling_wt", out=1)
dt1.1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "wasting",weight = "sampling_wt", out = 2)
dt2.1<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "wasting",weight = "sampling_wt", out=2)
dt3.1<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "wasting",weight = "sampling_wt", out=2)
dt1.1
dt2.1
dt3.1
ch2<-conc_chart(dt1, dt2, dt3, chart_of = "Wasting")
ch2
# concentration index for anemia
dt1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "Anemia",weight = "sampling_wt", out=1)
dt2<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "Anemia",weight = "sampling_wt",out=1)
dt3<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "Anemia",weight = "sampling_wt", out=1)
dt1.1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "Anemia",weight = "sampling_wt", out = 2)
dt2.1<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "Anemia",weight = "sampling_wt", out=2)
dt3.1<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "Anemia",weight = "sampling_wt", out=2)
dt1.1
dt2.1
dt3.1
ch3<-conc_chart(dt1, dt2, dt3, chart_of = "Anemia")
ch3
# concentration index for anemia
dt1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "cooccurence",weight = "sampling_wt", out=1)
dt2<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "cooccurence",weight = "sampling_wt", out=1)
dt3<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "cooccurence",weight = "sampling_wt", out=1)
dt1.1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "cooccurence",weight = "sampling_wt", out = 2)
dt2.1<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "cooccurence",weight = "sampling_wt", out=2)
dt3.1<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "cooccurence",weight = "sampling_wt", out=2)
dt1.1
dt2.1
dt3.1
ch4<-conc_chart(dt1, dt2, dt3, chart_of = "Co-occurence")
ch4
library("patchwork")
library(cowplot)
library(gridExtra)
p123<-ch1+ch2+ch3+ch4+plot_layout(ncol=2, guides = "collect",axis_titles = "collect", design = "AB\nCD\nEF",tag_level = "keep") & theme(legend.position = 'bottom')
p123
plot_grid( ch1,ch2,ch3,ch4,
labels = c("A", "B", "C", "D"),
hjust = -1,
nrow = 2)+xlab("Cummulative share of women ranked by wealth")+
ylab("Cummulative share of Nutritonla status")
dt1.1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "cooccurence",weight = "sampling_wt", out = 2)
dt1.1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "cooccurence",weight = "sampling_wt", out = 2)
dt2.1<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "cooccurence",weight = "sampling_wt", out=2)
dt3.1<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "cooccurence",weight = "sampling_wt", out=2)
plot_grid( ch1,ch2,ch3,ch4,
labels = c("A", "B", "C", "D"),
hjust = -1,
nrow = 2)+xlab("Cummulative share of women ranked by wealth")+
ylab("Cummulative share of Nutritonla status")
p123<-ch1+ch2+ch3+ch4+plot_layout(ncol=2, guides = "collect",axis_titles = "collect", design = "AB\nCD\nEF",tag_level = "keep") & theme(legend.position = 'bottom')
plot_grid( ch1,ch2,ch3,ch4,
labels = c("A", "B", "C", "D"),
hjust = -1,
nrow = 2)+xlab("Cummulative share of women ranked by wealth")+
ylab("Cummulative share of Nutritonla status")
p123<-ch1+ch2+ch3+ch4+plot_layout(ncol=2, guides = "collect",axis_titles = "collect", design = "AB\nCD",tag_level = "keep") & theme(legend.position = 'bottom')
p123
conc_chart <- function(dt1, dt2, dt3, chart_of){
chart1<-ggplot()+
geom_segment(aes(x = 0, xend = 1, y = 0, yend = 1),col="black", lwd=1.3)+
geom_line(data=dt1,aes(x=xCoord, y = cumdist,col="2022"), lwd=1.1)+
geom_line(data=dt2,aes(x=xCoord, y = cumdist,col="2016"), lwd=1.1)+
geom_line(data=dt3,aes(x=xCoord, y = cumdist,col="2011"), lwd=1.1)+
scale_y_continuous(
paste0("Cummulative share of ", chart_of, "\n"), expand = c(0, 0),
sec.axis = sec_axis(~ . *1)
)+
scale_x_continuous(
"\nCummulative share of children ranked by wealth", expand = c(0, 0),
sec.axis = sec_axis(~ . *1)
)+
scale_color_manual("Year",values = c("orange", "red","navy"))+
labs(title = "A")+
theme_bw()+
theme(axis.title = element_text(size = 13, face="bold"),
legend.title = element_text(size=13, face="bold"),
axis.text.y.right = element_blank(),
axis.text.x.top = element_blank())
return(chart1)
}
# Concentration index for stunting
dt1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt", out = 1)
dt2<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt", out=1)
dt3<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt", out=1)
dt1.1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt", out = 2)
dt2.1<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt", out=2)
dt3.1<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt", out=2)
ch1<-conc_chart(dt1, dt2, dt3, chart_of = "Stunting")
ch1
# concentration index for wasting
dt1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "wasting",weight = "sampling_wt", out=1)
dt2<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "wasting",weight = "sampling_wt", out=1)
dt3<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "wasting",weight = "sampling_wt", out=1)
dt1.1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "wasting",weight = "sampling_wt", out = 2)
dt2.1<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "wasting",weight = "sampling_wt", out=2)
dt3.1<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "wasting",weight = "sampling_wt", out=2)
ch2<-conc_chart(dt1, dt2, dt3, chart_of = "Wasting")
ch2
# concentration index for anemia
dt1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "Anemia",weight = "sampling_wt", out=1)
dt2<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "Anemia",weight = "sampling_wt",out=1)
dt3<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "Anemia",weight = "sampling_wt", out=1)
dt1.1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "Anemia",weight = "sampling_wt", out = 2)
dt2.1<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "Anemia",weight = "sampling_wt", out=2)
dt3.1<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "Anemia",weight = "sampling_wt", out=2)
ch3<-conc_chart(dt1, dt2, dt3, chart_of = "Anemia")
ch3
# concentration index for anemia
dt1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "cooccurence",weight = "sampling_wt", out=1)
dt2<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "cooccurence",weight = "sampling_wt", out=1)
dt3<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "cooccurence",weight = "sampling_wt", out=1)
dt1.1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "cooccurence",weight = "sampling_wt", out = 2)
dt2.1<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "cooccurence",weight = "sampling_wt", out=2)
dt3.1<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "cooccurence",weight = "sampling_wt", out=2)
ch4<-conc_chart(dt1, dt2, dt3, chart_of = "Co-occurence")
ch4
library("patchwork")
library(cowplot)
library(gridExtra)
p123<-ch1+ch2+ch3+ch4+plot_layout(ncol=2, guides = "collect",axis_titles = "collect", design = "AB\nCD",tag_level = "keep") & theme(legend.position = 'bottom')
p123
plot_grid( ch1,ch2,ch3,ch4,
labels = c("A", "B", "C", "D"),
hjust = -1,
nrow = 2)+xlab("Cummulative share of women ranked by wealth")+
ylab("Cummulative share of Nutritonla status")
p123<-ch1+ch2+ch3+ch4+plot_layout(ncol=2, guides = "collect",axis_titles =  = "collect_x", design = "AB\nCD",tag_level = "keep") & theme(legend.position = 'bottom')
p123<-ch1+ch2+ch3+ch4+plot_layout(ncol=2, guides = "collect",axis_titles =  "collect_x", design = "AB\nCD",tag_level = "keep") & theme(legend.position = 'bottom')
p123
chart1<-ggplot()+
geom_segment(aes(x = 0, xend = 1, y = 0, yend = 1),col="black", lwd=1.3)+
geom_line(data=dt1,aes(x=xCoord, y = cumdist,col="2022"), lwd=1.1)+
geom_line(data=dt2,aes(x=xCoord, y = cumdist,col="2016"), lwd=1.1)+
geom_line(data=dt3,aes(x=xCoord, y = cumdist,col="2011"), lwd=1.1)+
scale_y_continuous(
paste0("Cummulative share of ", chart_of, "\n"), expand = c(0, 0),
sec.axis = sec_axis(~ . *1)
)+
scale_x_continuous(
"\nCummulative share of children ranked by wealth", expand = c(0, 0),
sec.axis = sec_axis(~ . *1)
)+
scale_color_manual("Year",values = c("orange", "red","navy"))+
labs(title = "A")+
theme_bw()+
theme(axis.title = element_text(size = 10, face="bold"),
legend.title = element_text(size=10, face="bold"),
axis.text.y.right = element_blank(),
axis.text.x.top = element_blank())
conc_chart <- function(dt1, dt2, dt3, chart_of){
chart1<-ggplot()+
geom_segment(aes(x = 0, xend = 1, y = 0, yend = 1),col="black", lwd=1.3)+
geom_line(data=dt1,aes(x=xCoord, y = cumdist,col="2022"), lwd=1.1)+
geom_line(data=dt2,aes(x=xCoord, y = cumdist,col="2016"), lwd=1.1)+
geom_line(data=dt3,aes(x=xCoord, y = cumdist,col="2011"), lwd=1.1)+
scale_y_continuous(
paste0("Cummulative share of ", chart_of, "\n"), expand = c(0, 0),
sec.axis = sec_axis(~ . *1)
)+
scale_x_continuous(
"\nCummulative share of children ranked by wealth", expand = c(0, 0),
sec.axis = sec_axis(~ . *1)
)+
scale_color_manual("Year",values = c("orange", "red","navy"))+
labs(title = "A")+
theme_bw()+
theme(axis.title = element_text(size = 10, face="bold"),
legend.title = element_text(size=10, face="bold"),
axis.text.y.right = element_blank(),
axis.text.x.top = element_blank())
return(chart1)
}
# Concentration index for stunting
dt1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt", out = 1)
dt2<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt", out=1)
dt3<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt", out=1)
dt1.1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt", out = 2)
dt2.1<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt", out=2)
dt3.1<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "stunting",weight = "sampling_wt", out=2)
ch1<-conc_chart(dt1, dt2, dt3, chart_of = "Stunting")
ch1
# concentration index for wasting
dt1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "wasting",weight = "sampling_wt", out=1)
dt2<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "wasting",weight = "sampling_wt", out=1)
dt3<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "wasting",weight = "sampling_wt", out=1)
dt1.1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "wasting",weight = "sampling_wt", out = 2)
dt2.1<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "wasting",weight = "sampling_wt", out=2)
dt3.1<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "wasting",weight = "sampling_wt", out=2)
ch2<-conc_chart(dt1, dt2, dt3, chart_of = "Wasting")
ch2
# concentration index for anemia
dt1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "Anemia",weight = "sampling_wt", out=1)
dt2<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "Anemia",weight = "sampling_wt",out=1)
dt3<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "Anemia",weight = "sampling_wt", out=1)
dt1.1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "Anemia",weight = "sampling_wt", out = 2)
dt2.1<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "Anemia",weight = "sampling_wt", out=2)
dt3.1<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "Anemia",weight = "sampling_wt", out=2)
ch3<-conc_chart(dt1, dt2, dt3, chart_of = "Anemia")
ch3
# concentration index for anemia
dt1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "cooccurence",weight = "sampling_wt", out=1)
dt2<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "cooccurence",weight = "sampling_wt", out=1)
dt3<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "cooccurence",weight = "sampling_wt", out=1)
dt1.1<-concentration_curve(dt = PRdata[PRdata$Year== 2022,], inq_var ="hv270", outcome = "cooccurence",weight = "sampling_wt", out = 2)
dt2.1<-concentration_curve(dt = PRdata[PRdata$Year== 2016,], inq_var ="hv270", outcome = "cooccurence",weight = "sampling_wt", out=2)
dt3.1<-concentration_curve(dt = PRdata[PRdata$Year== 2011,], inq_var ="hv270", outcome = "cooccurence",weight = "sampling_wt", out=2)
ch4<-conc_chart(dt1, dt2, dt3, chart_of = "Co-occurence")
ch4
library("patchwork")
library(cowplot)
library(gridExtra)
p123<-ch1+ch2+ch3+ch4+plot_layout(ncol=2, guides = "collect",axis_titles =  "collect_x", design = "AB\nCD",tag_level = "keep") & theme(legend.position = 'bottom')
p123
p123<-ch1+ch2+ch3+ch4+plot_layout(ncol=2, guides = "keep",axis_titles =  "collect_x", design = "AB\nCD",tag_level = "keep") & theme(legend.position = 'bottom')
p123
guides = "collect
p123<-ch1+ch2+ch3+ch4+plot_layout(ncol=2, guides = "collect",axis_titles =  "collect_x", design = "AB\nCD",tag_level = "keep") & theme(legend.position = 'bottom')
p123
p123<-ch1+ch2+ch3+ch4+plot_layout(ncol=2, guides = "collect",axis_titles =  "collect_x", design = "AB\nCD",tag_level = "keep") & theme(legend.position = 'bottom')
p123
