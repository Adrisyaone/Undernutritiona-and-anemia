set_variable_labels(nt_ch_stunt = "Stunted child under 5 years")
# //Mean haz
PRdata <- PRdata %>%
mutate(haz = case_when(hv103 ==1 & hc70<996 ~ hc70/100))
PRdata$nt_ch_mean_haz <- matrixStats::weightedMean(PRdata$haz, PRdata$wt, idxs = NULL, na.rm = TRUE)
# //Severely wasted
PRdata <- PRdata %>%
mutate(nt_ch_sev_wast =
case_when(
hv103==1 &  hc72< -300  ~ 1 ,
hv103==1 &  hc72>= -300 & hc72<9996 ~ 0 ,
hc72>=9996 ~ 99)) %>%
replace_with_na(replace = list(nt_ch_sev_wast = c(99))) %>%
set_value_labels(nt_ch_sev_wast = c("Yes" = 1, "No"=0  )) %>%
set_variable_labels(nt_ch_sev_wast = "Severely wasted child under 5 years")
# //Wasted
PRdata <- PRdata %>%
mutate(nt_ch_wast =
case_when(
hv103==1 &  hc72< -200  ~ 1 ,
hv103==1 &  hc72>= -200 & hc72<9996~ 0 ,
hc72>=9996 ~ 99)) %>%
replace_with_na(replace = list(nt_ch_wast = c(99))) %>%
set_value_labels(nt_ch_wast = c("Yes" = 1, "No"=0  )) %>%
set_variable_labels(nt_ch_wast = "Wasted child under 5 years")
# //Overweight for height
PRdata <- PRdata %>%
mutate(nt_ch_ovwt_ht =
case_when(
hv103==1 &  hc72> 200 & hc72<9996 ~ 1 ,
hv103==1 &  hc72<= 200 & hc72<9996 ~ 0 ,
hc72>=9996 ~ 99)) %>%
replace_with_na(replace = list(nt_ch_ovwt_ht = c(99))) %>%
set_value_labels(nt_ch_ovwt_ht = c("Yes" = 1, "No"=0  )) %>%
set_variable_labels(nt_ch_ovwt_ht = "Overweight for height child under 5 years")
# //Mean whz
PRdata <- PRdata %>%
mutate(whz = case_when(hv103 ==1 & hc72<996 ~ hc72/100))
PRdata$nt_ch_mean_whz <- matrixStats::weightedMean(PRdata$whz, PRdata$wt, idxs = NULL, na.rm = TRUE)
# //Severely underweight
PRdata <- PRdata %>%
mutate(nt_ch_sev_underwt =
case_when(
hv103==1 &  hc71< -300  ~ 1 ,
hv103==1 &  hc71>= -300 & hc71<9996 ~ 0 ,
hc71>=9996 ~ 99)) %>%
replace_with_na(replace = list(nt_ch_sev_underwt = c(99))) %>%
set_value_labels(nt_ch_sev_underwt = c("Yes" = 1, "No"=0  )) %>%
set_variable_labels(nt_ch_sev_underwt = "Severely underweight child under 5 years")
# //Underweight
PRdata <- PRdata %>%
mutate(nt_ch_underwt =
case_when(
hv103==1 &  hc71< -200  ~ 1 ,
hv103==1 &  hc71>= -200  & hc71<9996 ~ 0 ,
hc71>=9996 ~ 99)) %>%
replace_with_na(replace = list(nt_ch_underwt = c(99))) %>%
set_value_labels(nt_ch_underwt = c("Yes" = 1, "No"=0  )) %>%
set_variable_labels(nt_ch_underwt = "Underweight child under 5 years")
#
# //Overweight for age
PRdata <- PRdata %>%
mutate(nt_ch_ovwt_age =
case_when(
hv103==1 &  hc71> 200 & hc71<9996 ~ 1 ,
hv103==1 &  hc71<= 200  & hc71<9996 ~ 0 ,
hc71>=9996 ~ 99)) %>%
replace_with_na(replace = list(nt_ch_ovwt_age = c(99))) %>%
set_value_labels(nt_ch_ovwt_age = c("Yes" = 1, "No"=0  )) %>%
set_variable_labels(nt_ch_ovwt_age = "Overweight for age child under 5 years")
# //Mean waz
PRdata <- PRdata %>%
mutate(waz = case_when(hv103 ==1 & hc71<996 ~ hc71/100))
PRdata$nt_ch_mean_waz <- matrixStats::weightedMean(PRdata$waz, PRdata$wt, idxs = NULL, na.rm = TRUE)
# //Anemia indicators
# //Any anemia
PRdata <- PRdata %>%
mutate(nt_ch_any_anem =
case_when(
hv103==1 & hc1>5 & hc1<60 & hc56<110 ~ 1 ,
hv103==1 & hc1>5 & hc1<60 & hc56>=110 ~ 0)) %>%
set_value_labels(nt_ch_any_anem = c("Yes" = 1, "No"=0  )) %>%
set_variable_labels(nt_ch_any_anem = "Any anemia - child 6-59 months")
# //Mild anemia
PRdata <- PRdata %>%
mutate(nt_ch_mild_anem =
case_when(
hv103==1 & hc1>5 & hc1<60 & hc56>99 & hc56<110 ~ 1 ,
hv103==1 & hc1>5 & hc1<60 & hc56<=99 | hc56>=110 ~ 0)) %>%
set_value_labels(nt_ch_mild_anem = c("Yes" = 1, "No"=0  )) %>%
set_variable_labels(nt_ch_mild_anem = "Mild anemia - child 6-59 months")
# //Moderate anemia
PRdata <- PRdata %>%
mutate(nt_ch_mod_anem =
case_when(
hv103==1 & hc1>5 & hc1<60 & hc56>69 & hc56<100 ~ 1 ,
hv103==1 & hc1>5 & hc1<60 & hc56<=69 | hc56>=100 ~ 0)) %>%
set_value_labels(nt_ch_mod_anem = c("Yes" = 1, "No"=0  )) %>%
set_variable_labels(nt_ch_mod_anem = "Moderate anemia - child 6-59 months")
# //Severe anemia
PRdata <- PRdata %>%
mutate(nt_ch_sev_anem =
case_when(
hv103==1 & hc1>5 & hc1<60 & hc56<70 ~ 1 ,
hv103==1 & hc1>5 & hc1<60 & hc56>=70 ~ 0)) %>%
set_value_labels(nt_ch_sev_anem = c("Yes" = 1, "No"=0  )) %>%
set_variable_labels(nt_ch_sev_anem = "Severe anemia - child 6-59 months")
# Demographic variables
PRdata <- PRdata %>%
mutate(agemonths = case_when(hc1<6~ 1, hc1%in%c(6,7,8)~ 2, hc1%in%c(9,10,11)~ 3, hc1>=12&hc1<=17~ 4,
hc1>=18&hc1<=23~ 5, hc1>=24&hc1<=35~ 6, hc1>=36&hc1<=47~ 7, hc1>=48&hc1<=59~ 8),
shdist=shdistrict,
education=factor(hc61, levels=c(0:3), labels=c("No education", "Primary", "Secondary", "Above")),
hv024==NA,
sh145a=sh130,
sh145b=sh131,
sh145c=sh132,
sh145e=sh133,
sh145f=sh134,
sh145g=sh135,
sh145h=sh136,
hds_cat=case_when((sh145a==0 |sh145a==1) & (sh145b==0 & sh145c==0  & sh145e==0 & sh145f==0 & sh145g==0 & sh145h==0 )~1,
(sh145a==2 |sh145a==3 | sh145b==1 |sh145b==2 |sh145b==3| sh145c==1 ) & sh145e==0 & sh145f==0 & sh145g==0 & sh145h==0 ~2,
(sh145c==2 |sh145c==3 |sh145e==1 |sh145e==2 |sh145f==1 |sh145f==2) & sh145g==0 & sh145h==0 ~3,
(sh145e==3 |sh145f==3 |sh145g==1 |sh145g==2 |sh145g==3 |sh145h==1 |sh145h==2 |sh145h==3)~4),
hfs=factor(hds_cat, levels=c(1:4), labels=c("No", "Mild", "Moderate", "Severe"), ordered = T)) %>%
set_value_labels(agemonths = c("<6"=1, "6-8"=2, "9-11"=3, "12-17"=4, "18-23"=5, "24-35"=6, "36-47"=7, "48-59"=8 )) %>%
set_variable_labels(agemonths = "Age of child months categories") |>
filter(hc1>5 & hc1<60) |>
# filter(!is.na(nt_ch_any_anem) |!is.na(nt_ch_stunt) ) |>
# filter(!is.na(nt_ch_stunt)) |>
# filter(!is.na(nt_ch_any_anem)) |>
# filter(!is.na(nt_ch_wast))
# PRdata <- forcats::as_factor(PRdata, only_labelled = TRUE)
PRdata11<-PRdata |>
mutate(Year=2011) |>
select(Year,hv021, hv022, hv005, agemonths, hc27, shecoreg, shdist,hv025, hv024,education, hv270, nt_ch_ovwt_ht, nt_ch_mean_haz, nt_ch_mean_whz, nt_ch_underwt, nt_ch_sev_underwt,nt_ch_stunt,nt_ch_sev_stunt,nt_ch_sev_wast,nt_ch_wast,nt_ch_ovwt_age,nt_ch_any_anem, nt_ch_mild_anem, nt_ch_mod_anem, nt_ch_sev_anem, hfs)
rm(list=ls())
# load Script 1
source("Script/1 Functions, load datasets and packages.R")
# PR data processing
PRdata<-PRdata2011
# Clean Outcome variables
# //Severely stunted
PRdata <- PRdata %>%
mutate(nt_ch_sev_stunt =
case_when(
hv103==1 &  hc70< -300  ~ 1 ,
hv103==1 &  hc70>= -300 & hc70<9996 ~ 0 ,
hc70>=9996 ~ 99)) %>%
replace_with_na(replace = list(nt_ch_sev_stunt = c(99))) %>%
set_value_labels(nt_ch_sev_stunt = c("Yes" = 1, "No"=0  )) %>%
set_variable_labels(nt_ch_sev_stunt = "Severely stunted child under 5 years")
# //Stunted
PRdata <- PRdata %>%
mutate(nt_ch_stunt =
case_when(
hv103==1 &  hc70< -200  ~ 1 ,
hv103==1 &  hc70>= -200 & hc70<9996 ~ 0 ,
hc70>=9996 ~ 99)) %>%
replace_with_na(replace = list(nt_ch_stunt = c(99))) %>%
set_value_labels(nt_ch_stunt = c("Yes" = 1, "No"=0  )) %>%
set_variable_labels(nt_ch_stunt = "Stunted child under 5 years")
# //Mean haz
PRdata <- PRdata %>%
mutate(haz = case_when(hv103 ==1 & hc70<996 ~ hc70/100))
PRdata$nt_ch_mean_haz <- matrixStats::weightedMean(PRdata$haz, PRdata$wt, idxs = NULL, na.rm = TRUE)
# //Severely wasted
PRdata <- PRdata %>%
mutate(nt_ch_sev_wast =
case_when(
hv103==1 &  hc72< -300  ~ 1 ,
hv103==1 &  hc72>= -300 & hc72<9996 ~ 0 ,
hc72>=9996 ~ 99)) %>%
replace_with_na(replace = list(nt_ch_sev_wast = c(99))) %>%
set_value_labels(nt_ch_sev_wast = c("Yes" = 1, "No"=0  )) %>%
set_variable_labels(nt_ch_sev_wast = "Severely wasted child under 5 years")
# //Wasted
PRdata <- PRdata %>%
mutate(nt_ch_wast =
case_when(
hv103==1 &  hc72< -200  ~ 1 ,
hv103==1 &  hc72>= -200 & hc72<9996~ 0 ,
hc72>=9996 ~ 99)) %>%
replace_with_na(replace = list(nt_ch_wast = c(99))) %>%
set_value_labels(nt_ch_wast = c("Yes" = 1, "No"=0  )) %>%
set_variable_labels(nt_ch_wast = "Wasted child under 5 years")
# //Overweight for height
PRdata <- PRdata %>%
mutate(nt_ch_ovwt_ht =
case_when(
hv103==1 &  hc72> 200 & hc72<9996 ~ 1 ,
hv103==1 &  hc72<= 200 & hc72<9996 ~ 0 ,
hc72>=9996 ~ 99)) %>%
replace_with_na(replace = list(nt_ch_ovwt_ht = c(99))) %>%
set_value_labels(nt_ch_ovwt_ht = c("Yes" = 1, "No"=0  )) %>%
set_variable_labels(nt_ch_ovwt_ht = "Overweight for height child under 5 years")
# //Mean whz
PRdata <- PRdata %>%
mutate(whz = case_when(hv103 ==1 & hc72<996 ~ hc72/100))
PRdata$nt_ch_mean_whz <- matrixStats::weightedMean(PRdata$whz, PRdata$wt, idxs = NULL, na.rm = TRUE)
# //Severely underweight
PRdata <- PRdata %>%
mutate(nt_ch_sev_underwt =
case_when(
hv103==1 &  hc71< -300  ~ 1 ,
hv103==1 &  hc71>= -300 & hc71<9996 ~ 0 ,
hc71>=9996 ~ 99)) %>%
replace_with_na(replace = list(nt_ch_sev_underwt = c(99))) %>%
set_value_labels(nt_ch_sev_underwt = c("Yes" = 1, "No"=0  )) %>%
set_variable_labels(nt_ch_sev_underwt = "Severely underweight child under 5 years")
# //Underweight
PRdata <- PRdata %>%
mutate(nt_ch_underwt =
case_when(
hv103==1 &  hc71< -200  ~ 1 ,
hv103==1 &  hc71>= -200  & hc71<9996 ~ 0 ,
hc71>=9996 ~ 99)) %>%
replace_with_na(replace = list(nt_ch_underwt = c(99))) %>%
set_value_labels(nt_ch_underwt = c("Yes" = 1, "No"=0  )) %>%
set_variable_labels(nt_ch_underwt = "Underweight child under 5 years")
#
# //Overweight for age
PRdata <- PRdata %>%
mutate(nt_ch_ovwt_age =
case_when(
hv103==1 &  hc71> 200 & hc71<9996 ~ 1 ,
hv103==1 &  hc71<= 200  & hc71<9996 ~ 0 ,
hc71>=9996 ~ 99)) %>%
replace_with_na(replace = list(nt_ch_ovwt_age = c(99))) %>%
set_value_labels(nt_ch_ovwt_age = c("Yes" = 1, "No"=0  )) %>%
set_variable_labels(nt_ch_ovwt_age = "Overweight for age child under 5 years")
# //Mean waz
PRdata <- PRdata %>%
mutate(waz = case_when(hv103 ==1 & hc71<996 ~ hc71/100))
PRdata$nt_ch_mean_waz <- matrixStats::weightedMean(PRdata$waz, PRdata$wt, idxs = NULL, na.rm = TRUE)
# //Anemia indicators
# //Any anemia
PRdata <- PRdata %>%
mutate(nt_ch_any_anem =
case_when(
hv103==1 & hc1>5 & hc1<60 & hc56<110 ~ 1 ,
hv103==1 & hc1>5 & hc1<60 & hc56>=110 ~ 0)) %>%
set_value_labels(nt_ch_any_anem = c("Yes" = 1, "No"=0  )) %>%
set_variable_labels(nt_ch_any_anem = "Any anemia - child 6-59 months")
# //Mild anemia
PRdata <- PRdata %>%
mutate(nt_ch_mild_anem =
case_when(
hv103==1 & hc1>5 & hc1<60 & hc56>99 & hc56<110 ~ 1 ,
hv103==1 & hc1>5 & hc1<60 & hc56<=99 | hc56>=110 ~ 0)) %>%
set_value_labels(nt_ch_mild_anem = c("Yes" = 1, "No"=0  )) %>%
set_variable_labels(nt_ch_mild_anem = "Mild anemia - child 6-59 months")
# //Moderate anemia
PRdata <- PRdata %>%
mutate(nt_ch_mod_anem =
case_when(
hv103==1 & hc1>5 & hc1<60 & hc56>69 & hc56<100 ~ 1 ,
hv103==1 & hc1>5 & hc1<60 & hc56<=69 | hc56>=100 ~ 0)) %>%
set_value_labels(nt_ch_mod_anem = c("Yes" = 1, "No"=0  )) %>%
set_variable_labels(nt_ch_mod_anem = "Moderate anemia - child 6-59 months")
# //Severe anemia
PRdata <- PRdata %>%
mutate(nt_ch_sev_anem =
case_when(
hv103==1 & hc1>5 & hc1<60 & hc56<70 ~ 1 ,
hv103==1 & hc1>5 & hc1<60 & hc56>=70 ~ 0)) %>%
set_value_labels(nt_ch_sev_anem = c("Yes" = 1, "No"=0  )) %>%
set_variable_labels(nt_ch_sev_anem = "Severe anemia - child 6-59 months")
# Demographic variables
PRdata <- PRdata %>%
mutate(agemonths = case_when(hc1<6~ 1, hc1%in%c(6,7,8)~ 2, hc1%in%c(9,10,11)~ 3, hc1>=12&hc1<=17~ 4,
hc1>=18&hc1<=23~ 5, hc1>=24&hc1<=35~ 6, hc1>=36&hc1<=47~ 7, hc1>=48&hc1<=59~ 8),
shdist=shdistrict,
education=factor(hc61, levels=c(0:3), labels=c("No education", "Primary", "Secondary", "Above")),
hv024==NA,
sh145a=sh130,
sh145b=sh131,
sh145c=sh132,
sh145e=sh133,
sh145f=sh134,
sh145g=sh135,
sh145h=sh136,
hds_cat=case_when((sh145a==0 |sh145a==1) & (sh145b==0 & sh145c==0  & sh145e==0 & sh145f==0 & sh145g==0 & sh145h==0 )~1,
(sh145a==2 |sh145a==3 | sh145b==1 |sh145b==2 |sh145b==3| sh145c==1 ) & sh145e==0 & sh145f==0 & sh145g==0 & sh145h==0 ~2,
(sh145c==2 |sh145c==3 |sh145e==1 |sh145e==2 |sh145f==1 |sh145f==2) & sh145g==0 & sh145h==0 ~3,
(sh145e==3 |sh145f==3 |sh145g==1 |sh145g==2 |sh145g==3 |sh145h==1 |sh145h==2 |sh145h==3)~4),
hfs=factor(hds_cat, levels=c(1:4), labels=c("No", "Mild", "Moderate", "Severe"), ordered = T)) %>%
set_value_labels(agemonths = c("<6"=1, "6-8"=2, "9-11"=3, "12-17"=4, "18-23"=5, "24-35"=6, "36-47"=7, "48-59"=8 )) %>%
set_variable_labels(agemonths = "Age of child months categories")
filter(hc1>5 & hc1<60) |>
# filter(!is.na(nt_ch_any_anem) |!is.na(nt_ch_stunt) ) |>
# filter(!is.na(nt_ch_stunt)) |>
# filter(!is.na(nt_ch_any_anem)) |>
# filter(!is.na(nt_ch_wast))
# PRdata <- forcats::as_factor(PRdata, only_labelled = TRUE)
PRdata11<-PRdata |>
mutate(Year=2011) |>
select(Year,hv021, hv022, hv005, agemonths, hc27, shecoreg, shdist,hv025, hv024,education, hv270, nt_ch_ovwt_ht, nt_ch_mean_haz, nt_ch_mean_whz, nt_ch_underwt, nt_ch_sev_underwt,nt_ch_stunt,nt_ch_sev_stunt,nt_ch_sev_wast,nt_ch_wast,nt_ch_ovwt_age,nt_ch_any_anem, nt_ch_mild_anem, nt_ch_mod_anem, nt_ch_sev_anem, hfs)
rm(list=ls())
# load Script 1
source("Script/1 Functions, load datasets and packages.R")
# PR data processing
PRdata<-PRdata2011
# Clean Outcome variables
# //Severely stunted
PRdata <- PRdata %>%
mutate(nt_ch_sev_stunt =
case_when(
hv103==1 &  hc70< -300  ~ 1 ,
hv103==1 &  hc70>= -300 & hc70<9996 ~ 0 ,
hc70>=9996 ~ 99)) %>%
replace_with_na(replace = list(nt_ch_sev_stunt = c(99))) %>%
set_value_labels(nt_ch_sev_stunt = c("Yes" = 1, "No"=0  )) %>%
set_variable_labels(nt_ch_sev_stunt = "Severely stunted child under 5 years")
# //Stunted
PRdata <- PRdata %>%
mutate(nt_ch_stunt =
case_when(
hv103==1 &  hc70< -200  ~ 1 ,
hv103==1 &  hc70>= -200 & hc70<9996 ~ 0 ,
hc70>=9996 ~ 99)) %>%
replace_with_na(replace = list(nt_ch_stunt = c(99))) %>%
set_value_labels(nt_ch_stunt = c("Yes" = 1, "No"=0  )) %>%
set_variable_labels(nt_ch_stunt = "Stunted child under 5 years")
# //Mean haz
PRdata <- PRdata %>%
mutate(haz = case_when(hv103 ==1 & hc70<996 ~ hc70/100))
PRdata$nt_ch_mean_haz <- matrixStats::weightedMean(PRdata$haz, PRdata$wt, idxs = NULL, na.rm = TRUE)
# //Severely wasted
PRdata <- PRdata %>%
mutate(nt_ch_sev_wast =
case_when(
hv103==1 &  hc72< -300  ~ 1 ,
hv103==1 &  hc72>= -300 & hc72<9996 ~ 0 ,
hc72>=9996 ~ 99)) %>%
replace_with_na(replace = list(nt_ch_sev_wast = c(99))) %>%
set_value_labels(nt_ch_sev_wast = c("Yes" = 1, "No"=0  )) %>%
set_variable_labels(nt_ch_sev_wast = "Severely wasted child under 5 years")
# //Wasted
PRdata <- PRdata %>%
mutate(nt_ch_wast =
case_when(
hv103==1 &  hc72< -200  ~ 1 ,
hv103==1 &  hc72>= -200 & hc72<9996~ 0 ,
hc72>=9996 ~ 99)) %>%
replace_with_na(replace = list(nt_ch_wast = c(99))) %>%
set_value_labels(nt_ch_wast = c("Yes" = 1, "No"=0  )) %>%
set_variable_labels(nt_ch_wast = "Wasted child under 5 years")
# //Overweight for height
PRdata <- PRdata %>%
mutate(nt_ch_ovwt_ht =
case_when(
hv103==1 &  hc72> 200 & hc72<9996 ~ 1 ,
hv103==1 &  hc72<= 200 & hc72<9996 ~ 0 ,
hc72>=9996 ~ 99)) %>%
replace_with_na(replace = list(nt_ch_ovwt_ht = c(99))) %>%
set_value_labels(nt_ch_ovwt_ht = c("Yes" = 1, "No"=0  )) %>%
set_variable_labels(nt_ch_ovwt_ht = "Overweight for height child under 5 years")
# //Mean whz
PRdata <- PRdata %>%
mutate(whz = case_when(hv103 ==1 & hc72<996 ~ hc72/100))
PRdata$nt_ch_mean_whz <- matrixStats::weightedMean(PRdata$whz, PRdata$wt, idxs = NULL, na.rm = TRUE)
# //Severely underweight
PRdata <- PRdata %>%
mutate(nt_ch_sev_underwt =
case_when(
hv103==1 &  hc71< -300  ~ 1 ,
hv103==1 &  hc71>= -300 & hc71<9996 ~ 0 ,
hc71>=9996 ~ 99)) %>%
replace_with_na(replace = list(nt_ch_sev_underwt = c(99))) %>%
set_value_labels(nt_ch_sev_underwt = c("Yes" = 1, "No"=0  )) %>%
set_variable_labels(nt_ch_sev_underwt = "Severely underweight child under 5 years")
# //Underweight
PRdata <- PRdata %>%
mutate(nt_ch_underwt =
case_when(
hv103==1 &  hc71< -200  ~ 1 ,
hv103==1 &  hc71>= -200  & hc71<9996 ~ 0 ,
hc71>=9996 ~ 99)) %>%
replace_with_na(replace = list(nt_ch_underwt = c(99))) %>%
set_value_labels(nt_ch_underwt = c("Yes" = 1, "No"=0  )) %>%
set_variable_labels(nt_ch_underwt = "Underweight child under 5 years")
#
# //Overweight for age
PRdata <- PRdata %>%
mutate(nt_ch_ovwt_age =
case_when(
hv103==1 &  hc71> 200 & hc71<9996 ~ 1 ,
hv103==1 &  hc71<= 200  & hc71<9996 ~ 0 ,
hc71>=9996 ~ 99)) %>%
replace_with_na(replace = list(nt_ch_ovwt_age = c(99))) %>%
set_value_labels(nt_ch_ovwt_age = c("Yes" = 1, "No"=0  )) %>%
set_variable_labels(nt_ch_ovwt_age = "Overweight for age child under 5 years")
# //Mean waz
PRdata <- PRdata %>%
mutate(waz = case_when(hv103 ==1 & hc71<996 ~ hc71/100))
PRdata$nt_ch_mean_waz <- matrixStats::weightedMean(PRdata$waz, PRdata$wt, idxs = NULL, na.rm = TRUE)
# //Anemia indicators
# //Any anemia
PRdata <- PRdata %>%
mutate(nt_ch_any_anem =
case_when(
hv103==1 & hc1>5 & hc1<60 & hc56<110 ~ 1 ,
hv103==1 & hc1>5 & hc1<60 & hc56>=110 ~ 0)) %>%
set_value_labels(nt_ch_any_anem = c("Yes" = 1, "No"=0  )) %>%
set_variable_labels(nt_ch_any_anem = "Any anemia - child 6-59 months")
# //Mild anemia
PRdata <- PRdata %>%
mutate(nt_ch_mild_anem =
case_when(
hv103==1 & hc1>5 & hc1<60 & hc56>99 & hc56<110 ~ 1 ,
hv103==1 & hc1>5 & hc1<60 & hc56<=99 | hc56>=110 ~ 0)) %>%
set_value_labels(nt_ch_mild_anem = c("Yes" = 1, "No"=0  )) %>%
set_variable_labels(nt_ch_mild_anem = "Mild anemia - child 6-59 months")
# //Moderate anemia
PRdata <- PRdata %>%
mutate(nt_ch_mod_anem =
case_when(
hv103==1 & hc1>5 & hc1<60 & hc56>69 & hc56<100 ~ 1 ,
hv103==1 & hc1>5 & hc1<60 & hc56<=69 | hc56>=100 ~ 0)) %>%
set_value_labels(nt_ch_mod_anem = c("Yes" = 1, "No"=0  )) %>%
set_variable_labels(nt_ch_mod_anem = "Moderate anemia - child 6-59 months")
# //Severe anemia
PRdata <- PRdata %>%
mutate(nt_ch_sev_anem =
case_when(
hv103==1 & hc1>5 & hc1<60 & hc56<70 ~ 1 ,
hv103==1 & hc1>5 & hc1<60 & hc56>=70 ~ 0)) %>%
set_value_labels(nt_ch_sev_anem = c("Yes" = 1, "No"=0  )) %>%
set_variable_labels(nt_ch_sev_anem = "Severe anemia - child 6-59 months")
# Demographic variables
PRdata <- PRdata %>%
mutate(agemonths = case_when(hc1<6~ 1, hc1%in%c(6,7,8)~ 2, hc1%in%c(9,10,11)~ 3, hc1>=12&hc1<=17~ 4,
hc1>=18&hc1<=23~ 5, hc1>=24&hc1<=35~ 6, hc1>=36&hc1<=47~ 7, hc1>=48&hc1<=59~ 8),
shdist=shdistrict,
education=factor(hc61, levels=c(0:3), labels=c("No education", "Primary", "Secondary", "Above")),
hv024==NA,
sh145a=sh130,
sh145b=sh131,
sh145c=sh132,
sh145e=sh133,
sh145f=sh134,
sh145g=sh135,
sh145h=sh136,
hds_cat=case_when((sh145a==0 |sh145a==1) & (sh145b==0 & sh145c==0  & sh145e==0 & sh145f==0 & sh145g==0 & sh145h==0 )~1,
(sh145a==2 |sh145a==3 | sh145b==1 |sh145b==2 |sh145b==3| sh145c==1 ) & sh145e==0 & sh145f==0 & sh145g==0 & sh145h==0 ~2,
(sh145c==2 |sh145c==3 |sh145e==1 |sh145e==2 |sh145f==1 |sh145f==2) & sh145g==0 & sh145h==0 ~3,
(sh145e==3 |sh145f==3 |sh145g==1 |sh145g==2 |sh145g==3 |sh145h==1 |sh145h==2 |sh145h==3)~4),
hfs=factor(hds_cat, levels=c(1:4), labels=c("No", "Mild", "Moderate", "Severe"), ordered = T)) %>%
set_value_labels(agemonths = c("<6"=1, "6-8"=2, "9-11"=3, "12-17"=4, "18-23"=5, "24-35"=6, "36-47"=7, "48-59"=8 )) %>%
set_variable_labels(agemonths = "Age of child months categories") |>
filter(hc1>5 & hc1<60)
# filter(!is.na(nt_ch_any_anem) |!is.na(nt_ch_stunt) ) |>
# filter(!is.na(nt_ch_stunt)) |>
# filter(!is.na(nt_ch_any_anem)) |>
# filter(!is.na(nt_ch_wast))
# PRdata <- forcats::as_factor(PRdata, only_labelled = TRUE)
PRdata11<-PRdata |>
mutate(Year=2011) |>
select(Year,hv021, hv022, hv005, agemonths, hc27, shecoreg, shdist,hv025, hv024,education, hv270, nt_ch_ovwt_ht, nt_ch_mean_haz, nt_ch_mean_whz, nt_ch_underwt, nt_ch_sev_underwt,nt_ch_stunt,nt_ch_sev_stunt,nt_ch_sev_wast,nt_ch_wast,nt_ch_ovwt_age,nt_ch_any_anem, nt_ch_mild_anem, nt_ch_mod_anem, nt_ch_sev_anem, hfs)
saveRDS(PRdata11, "Datasets/Processed data/PRdata2011.RDS")
# load libraries
lapply(Packages, require, character.only=T)
# load datasets
PRdata22<-readRDS("Datasets/Processed data/PRdata2022.RDS")
PRdata16<-readRDS("Datasets/Processed data/PRdata2016.RDS")
PRdata11<-readRDS("Datasets/Processed data/PRdata2011.RDS")
# merge datasets
PRdata<-bind_rows(PRdata22, PRdata16, PRdata11)
# set sampling wt to correct length
PRdata <- PRdata %>%
mutate(sampling_wt = hv005/1000000) |>
mutate(combined_indicator=paste0(nt_ch_stunt, nt_ch_wast, nt_ch_any_anem),
agemonths<-as.factor(agemonths),
stunting=ifelse(nt_ch_stunt==1, 1,0),
wasting=ifelse(nt_ch_wast==1, 1,0),
Anemia=ifelse(nt_ch_any_anem==1, 1,0),
cooccurence=ifelse(combined_indicator=="111",1, 0),
hfs2=as.factor(as.character(hfs)))
# labelling data
PRdata <- forcats::as_factor(PRdata, only_labelled = TRUE)
# Descriptive statistics
svy_dt<-svydesign(data = PRdata[PRdata$Year==2011,], ids = ~hv021, weights = ~sampling_wt)
svy_dt %>%
tbl_svysummary(include =c("hfs",'nt_ch_wast',  'nt_ch_any_anem', "combined_indicator"),
digits = list(all_categorical()~c(0,1)), by="nt_ch_stunt", percent = "row") |>
add_ci(style_fun = list(all_categorical() ~ purrr::partial(style_percent, digits = 1))) |>
bold_labels()
PRdata$stunting
PRdata$nt_ch_stunt
svy_dt %>%
tbl_svysummary(include =c("hfs",'nt_ch_wast',  'nt_ch_any_anem', "combined_indicator"),
digits = list(all_categorical()~c(0,1)), by="stunting", percent = "row") |>
add_ci(style_fun = list(all_categorical() ~ purrr::partial(style_percent, digits = 1))) |>
bold_labels()
PRdata[!is.na(PRdata$stunting),]
PRdata<-PRdata[!is.na(PRdata$stunting),]
# Descriptive statistics
svy_dt<-svydesign(data = PRdata[PRdata$Year==2011,], ids = ~hv021, weights = ~sampling_wt)
svy_dt %>%
tbl_svysummary(include =c("hfs"),
digits = list(all_categorical()~c(0,1)), by="stunting", percent = "row") |>
add_ci(style_fun = list(all_categorical() ~ purrr::partial(style_percent, digits = 1))) |>
bold_labels()
svy_dt %>%
tbl_svysummary(include =c("hfs"),
digits = list(all_categorical()~c(0,1)), by="stunting", percent = "row") |>
add_ci(style_fun = list(all_categorical() ~ purrr::partial(style_percent, digits = 1)), percent="row") |>
bold_labels()
PRdata2022$ha3
PRdata2022$hc60
